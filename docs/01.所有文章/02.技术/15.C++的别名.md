---
title: C++的别名
date: 2023-03-04 02:00:57
permalink: /pages/e5de9a/
categories:
  - 所有文章
  - 技术
description: C++技巧
---

别名是一种减少代码量、增加可读性的有效手段。而 C++ 是一个语法较为复杂的语言，别名的方法也有很多奇技淫巧。

## 1. 宏

```cpp
#define newName name
```

宏是最简单朴素的起别名方法了，可以用作任何对象。缺点是作用范围是全局的，很容易造成命名空间的污染。

一个好的项目，应该避免宏的滥用，多使用一些语法特性来替代宏。

## 2. 类型别名

```cpp
using NewType = Type; // typedef Type NewType;
```

using 的功能和 typedef 类似，但是有几个区别：

- using 需要 C++11。
- using 的类型后置，可读性好一些。（例如 `using Func = void (*)(int);` 对比 `typedef void (*Func)(int);`）
- using 支持模板：

```cpp
template <typename T>
using vec = std::vector<T>;
```

## 3. 命名空间别名

```cpp
namespace newNamesp = namesp_1::namesp_2::namesp_3;
```

有时候命名空间会嵌套好几层，或者命名空间名字太长。在这种情况下用命名空间别名会极大减少心智负担。

当然可能有人会说 `using namespace xxx;` 会更简洁。但是尽量别这么用，你永远不知道命名空间里可能有什么东西，会和你自己的变量名冲突。

## 4. 成员变量别名

```cpp
class A {
   public:
    union {
        int x;
        int y;
    };
};
int main(int argc, char** argv) {
    A a{0};
    a.x = 1;
    std::cout << a.y << std::endl;
    return 0;
}
```

这个代码使用了匿名 union 来为同一个数据取多个名字。例如 GLM 库就是这么写的。

当然这并不是那么推荐，如果 union 包裹的是 `std::string` 这种复杂的类型，就需要自己写类的构造、析构等函数。

所以更加通用的应该这么写：

```cpp
class A {
   private:
    int __data;

   public:
    int &x() { return __data; };
    int &y() { return __data; };
};
```

或者：

```cpp
class A {
   private:
    int __data;

   public:
    int getX() { return __data; };
    void setX(int __data) { this->__data = __data; };
    int getY() { return __data; };
    void setY(int __data) { this->__data = __data; };
};
```

这就看个人喜好了。
